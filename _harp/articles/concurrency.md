# Concurrency

### 1. Общее

1. **Monitor** - высокоуровневый механизм взаимодействия и синхронизации процессов, обеспечивающий доступ к неразделяемым ресурсам.
  - При многозадачности, основанной на мониторах, компилятор или интерпретатор прозрачно для программиста вставляет код блокировки-разблокировки в оформленные соответствующим образом процедуры, избавляя программиста от явного обращения к примитивам синхронизации.

1. **Semaphore** - семафор ограничивает количество потоков, которые могут войти в заданный участок кода.
  - Семафоры используются для синхронизации и защиты передачи данных через разделяемую память, а также для синхронизации работы процессов и потоков.

1. **Mutex** - двоичный простейший семафор, который может находиться в одном из двух состояний: отмеченном или неотмеченном. Он отличается от семафора тем, что только владеющий им поток может его освободить, т.е. перевести в отмеченное состояние.
  - Задача мьютекса — защита объекта от доступа к нему других потоков, отличных от того, который завладел мьютексом.
  - В каждый конкретный момент только один поток может владеть объектом, защищённым мьютексом.
  - Если другому потоку будет нужен доступ к переменной, защищённой мьютексом, то этот поток блокируется до тех пор, пока мьютекс не будет освобождён.

1. **Process** - процесс обладает автономной средой выполнения. 
  - Каждый процесс, в частности, имеет собственную область памяти.
  - Процесс обычно воспринимается, как синоним выполнению программы или приложения. Однако бывает, что одна приложения занимает несколько процессов.
  - Большинство реализаций JVM запускаются в едином процессе.
  - Java приложение может создать дополнительный процесс с помощью ProcessBuilder объекта.

1. **Thread** - потоки иногда называют легковесными процессами (lightweight processes). Потоки существуют внутри процесса - каждый процесс обладает хотя бы одним потоком.
  - Потоки делят ресурсы процесса, включая память и открытые файлы.
  - Приложение может быть как однопоточным, так и многопоточным, но всегда существует единственный "главный" поток, с которого запускается приложение.

1. **Thread safe** - участок кода, который работает корректно как в однопоточной, так и в многопоточной среде.
  - **Not thread safe** - участок кода, который работает корректо только в однопоточной среде.

1. **Thread affinity** - при старте потока, можно указать в рантайм среде, чтобы поток был привязан к определенному ядру.

1. **EDT (Event Dispatching Thread)** - специальный поток, используемый для обработки событий из очереди событий. Такой подход является концептом событийно-ориентированного программирования.
  - Такие GUI фреймворки, как, например, AWT или Swing, используют EDT.

1. **Race condition** - ошибка проектирования многопоточной системы или приложения, при которой работа системы или приложения зависит от того, в каком порядке выполняются части кода.

1. **Context switches** - когда планировщик временно приостанавливает работу потока, чтобы активировать другой поток.
  - Частое явление в приложениях с кучей потоков, что очень дорого им обходится из-за:
    + Сохранение и восстановление выполняемого контекста
    + Непостоянное местоположение в памяти
    + Затрачивание CPU на планирование потоков, которое нужно тратить на их использование.

1. **Atomic action (Атомарная операция)** - операция, выполняющаяся как единое целое, либо не выполняющаяся вовсе.
  - Атомарная операция не может быть прервана: она либо выполняется полностьбю, либо не выполняется вовсе.
  - Атомарная операция не производит изменений внешней среды во время выполнения, только по окончании.
  - Атомарная операция открыта влиянию только одного потока.

1. **Happened-before relationship** - отношение "выполняется прежде" двух событий, которое гарантирует, что память, записанная событием A будет видна для события B, т.е. событие А завершает свою запись перед тем, как B начнет чтение.
  - Данное отношение транзитивно, иррефлексивно, антисимметрично.
    + Транзитивно - для любых 3-х событий a, b, c, если событие a происходит перед b, и b происходит перед c, тогда a должно происходить перед c.
    + Иррефлексивно - ни одно событие не должно происходить перед собой.
    + Антисимметрично - если событие a должно произойти перед событием b, то обратное невозможно.

---

### 2. Java-specific

1. **JMM (Java Memory Model)** - описывает поведение потоков в среде исполнения Java.
  - Однопоточные программы выолняются псевдопоследовательно, то есть в реальности процессор может выполнять несколько операций за такт, заодно изменив их порядок, однако все зависимости по данным остаются, так что поведение не отличается от последовательного.

1. **`Thread`** - каждый поток ассоциируется с объектом этого класса.
  - `Thread.sleep()` отдает команду текущему потоку приостановить выполнение на указанное время.
  - `Thread.interrupted()` возвращает `true`, если выполнение потока было прервано.
  - `thread.join()` позволяет одному потоку ждать окончания выполнения другого (т.е. текущий ждет выполнения потока `thread`).

1. **`Runnable`** - интерфейс определяет единственный метод `run`, который должен содержать код, который будет выполняться в потоке.

1. **`volatile`** - данный модификатор указывает компилятору, что чтение перемнной будет производиться прямо из памяти, что позволяет нескольким потокам видеть последнее значение переменной.

---

### Источники

1. https://ru.wikipedia.org/wiki/%D0%9C%D1%8C%D1%8E%D1%82%D0%B5%D0%BA%D1%81
1. https://ru.wikipedia.org/wiki/%D0%9C%D0%BE%D0%BD%D0%B8%D1%82%D0%BE%D1%80_(%D1%81%D0%B8%D0%BD%D1%85%D1%80%D0%BE%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F)
1. https://en.wikipedia.org/wiki/Happened-before
1. https://docs.oracle.com/javase/tutorial/essential/concurrency/index.html
1. https://www.amazon.com/Java-Concurrency-Practice-Brian-Goetz/dp/0321349601/192-1511873-1398145?ie=UTF8&*Version*=1&*entries*=0
1. https://habrahabr.ru/company/golovachcourses/blog/256883/
1. http://ru.stackoverflow.com/questions/1271/%D0%9A%D0%BB%D1%8E%D1%87%D0%B5%D0%B2%D0%BE%D0%B5-%D1%81%D0%BB%D0%BE%D0%B2%D0%BE-volatile-%D0%B2-java
1. https://ru.wikipedia.org/wiki/%D0%90%D1%82%D0%BE%D0%BC%D0%B0%D1%80%D0%BD%D0%B0%D1%8F_%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F
